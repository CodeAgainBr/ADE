<section>
	<div class="row">
		<div class="col-12">
			<table class="table table-cadastro">
      	<thead>
      		<tr class="row no-gutters">
          	<th class="col col-pagination col-pagination-associados">
          		<div class="btn-group" role="group">
                <button class="btn btn-outline-success" ng-class="page1" ng-click="trocarPage(1)">Informações Gerais</button>
                <button class="btn btn-outline-success" ng-class="page2" ng-click="trocarPage(2)">Contato</button>
                <button class="btn btn-outline-success" ng-class="page3" ng-click="trocarPage(3)">Endereço</button>
                <button class="btn btn-outline-success" ng-class="page4" ng-click="trocarPage(4)">Parentes</button>
              </div>
            </th>
          </tr>
      	</thead>
        <tbody>
		  		<tr class="row no-gutters" ng-class="aba1">
            <td class="col-sm-2 col"><label for="nome">Nome:</label></td>
            <td class="col">
              <input id="nome" type="text" ng-model="associado.nome" class="form-control btn-sm" placeholder="Nome">
            </td>
          </tr>

          <tr class="row no-gutters" ng-class="aba1">
            <td class="col-sm-2 col"><label for="dataNascimento">Data de Nascimento:</label></td>
            <td class="col">
              <input id="dataNascimento" type="text" ng-model="associado.dataNascimento" class="form-control btn-sm date" placeholder="Ex: 10/10/2000">
            </td>
          </tr>

          <tr class="row no-gutters" ng-class="aba1">
            <td class="col-sm-2 col">
              <label for="localNascimento">Local de Nascimento:</label>
            </td>

            <td class="col">
              <input id="localNascimento" type="text" ng-model="associado.localNascimento" class="form-control btn-sm" placeholder="Local de Nascimento">
            </td>
          </tr>

          <tr class="row no-gutters" ng-class="aba1">
            <td class="col-sm-2 col">
              <label for="rg">RG:</label>
            </td>

            <td class="col">
              <input id="rg" type="text" ng-model="associado.rg" class="form-control btn-sm rg" placeholder="Ex: 9.999.999">
            </td>
          </tr>

          <tr class="row no-gutters" ng-class="aba1">
            <td class="col-sm-2 col">
              <label for="cpf">CPF:</label>
            </td>

            <td class="col">
              <input id="cpf" type="text" ng-model="associado.cpf" class="form-control btn-sm cpf" placeholder="Ex: 999.999.999-99">
            </td>
          </tr>

          <tr class="row no-gutters" ng-class="aba1">
            <td class="col-sm-2 col">
              <label for="prato">Prato Predileto:</label>
            </td>

            <td class="col">
              <input id="prato" type="text" ng-model="associado.prato" class="form-control btn-sm" placeholder="Prato preferido">
            </td>
          </tr>

          <tr class="row no-gutters" ng-class="aba1">
            <td class="col-sm-2 col">
              <label for="observacoes">Observações:</label>
            </td>

            <td class="col">
              <textarea id="observacoes" type="text" ng-model="associado.observacoes" class="form-control btn-sm" placeholder="Observações importantes"></textarea>
            </td>
          </tr>

          <tr class="row no-gutters" ng-class="aba2">
            <td class="col-lg-1 col-sm-2 col-3">
              <label for="telefone">Telefone:</label>
            </td>

            <td class="col">
              <input id="telefone" type="text" ng-model="associado.telefone" class="form-control btn-sm celular" placeholder="Ex: (99) 99999-9999">
            </td>
          </tr>

          <tr class="row no-gutters" ng-class="aba2">
            <td class="col-lg-1 col-sm-2 col-3">
              <label for="email">E-mail:</label>
            </td>

            <td class="col">
              <input id="email" type="email" ng-model="associado.email" class="form-control btn-sm" placeholder="Ex: email@email.com">
            </td>
          </tr>

          <tr class="row no-gutters" ng-class="aba3">
            <td class="col-lg-1 col-sm-2 col-3">
              <label for="cep">CEP:</label>
            </td>

            <td class="col">
              <input id="cep" type="text" ng-model="associado.cep" class="form-control btn-sm cep" placeholder="CEP">
            </td>
          </tr>

          <tr class="row no-gutters" ng-class="aba3">
            <td class="col-lg-1 col-sm-2 col-3">
              <label for="rua">Rua:</label>
            </td>

            <td class="col">
              <input id="rua" type="text" ng-model="associado.rua" class="form-control btn-sm" placeholder="Nome da rua">
            </td>
          </tr>

          <tr class="row no-gutters" ng-class="aba3">
            <td class="col-lg-1 col-sm-2 col-3">
              <label for="numero">Nº:</label>
            </td>

            <td class="col">
              <input id="numero" type="text" ng-model="associado.numero" class="form-control btn-sm" placeholder="Número">
            </td>
          </tr>

          <tr class="row no-gutters" ng-class="aba3">
            <td class="col-lg-1 col-sm-2 col-3">
              <label for="bairro">Bairro:</label>
            </td>

            <td class="col">
              <input id="bairro" type="text" ng-model="associado.bairro" class="form-control btn-sm" placeholder="Nome do bairro">
            </td>
          </tr>

          <tr class="row no-gutters" ng-class="aba3">
            <td class="col-lg-1 col-sm-2 col-3">
              <label for="cidade">Cidade:</label>
            </td>

            <td class="col">
              <input id="cidade" type="text" ng-model="associado.cidade" class="form-control btn-sm" placeholder="Nome da cidade">
            </td>
          </tr>

          <tr class="row no-gutters" ng-class="aba3">
            <td class="col-lg-1 col-sm-2 col-3">
              <label for="estado">Estado:</label>
            </td>

            <td class="col">
              <input id="estado" type="text" ng-model="associado.estado" class="form-control btn-sm" maxlength="2" placeholder="Ex: SC">
            </td>
          </tr>

          <tr class="row no-gutters" ng-class="aba4">
            <td class="col">
              <table class="table table-stripped">
                <thead>
                  <tr>
                    <button class="btn btn-success btn-block btn-lg btn-table" ng-click="novoParente()">
                      <i class="fas fa-plus"></i> Adicionar Parente
                    </button>
                  </tr>
                </thead>
                <tbody>
                  <tr class="row no-gutters" ng-repeat="parente in associado.parentes">
                    <td class="col-sm-4 col-12">
                      <input class="form-control btn-sm" type="text" ng-model="parente.nome" placeholder="Nome do Parente">
                    </td>

                    <td class="col-sm-4 col-12">
                      <input class="form-control btn-sm" type="text" ng-model="parente.parentesco" placeholder="Parentesco">
                    </td>

                    <td class="col-sm-3 col-12">
                      <input class="form-control btn-sm date" type="text" ng-model="parente.nascimento" placeholder="Data de Nascimento">
                    </td>

                    <td class="col-sm-1 col-12">
                      <button class="btn btn-danger btn-sm btn-block" ng-click="apagarParente($index);">Apagar</button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </td>
          </tr>

          <tr class="row no-gutters">
            <td class="col-auto">
            	<button class="btn btn-danger btn-sm" onclick="window.location = '#!/associados';">Cancelar</button>
            </td>
            <td class="col-auto ml-auto">
            	<button class="btn btn-info btn-sm" onclick="window.location = '#!/associados';">Salvar</button>
            </td>
          </tr>
        </tbody>
      </table>
		</div>
	</div>
</section>

<script>
	$(document).ready(function() {
		$('.cep').mask('00000-000');
		$('.date').mask('00/00/0000');
    $('.celular').mask('(00) 00000-0000');
    $('.rg').mask('0.000.000');
    $('.cpf').mask('000.000.000-00');
	});

	$(document).ready(function(){
		function limpa_formulario_cep() {
      // Limpa valores do formulário de cep.
      $("#rua").val("");
      $("#bairro").val("");
      $("#cidade").val("");
      $("#estado").val("");
      $("#rua").prop('disabled', false);
      $("#bairro").prop('disabled', false);
      $("#cidade").prop('disabled', false);
      $("#estado").prop('disabled', false);
    }
    
    //Quando o campo cep perde o foco.
    $("#cep").blur(function() {

      //Nova variável "cep" somente com dígitos.
      var cep = $(this).val().replace(/\D/g, '');

      //Verifica se campo cep possui valor informado.
      if (cep != "") {

          //Expressão regular para validar o CEP.
          var validacep = /^[0-9]{8}$/;

          //Valida o formato do CEP.
          if(validacep.test(cep)) {
            //Preenche os campos com "..." enquanto consulta webservice.
            $("#rua").val("...");
            $("#bairro").val("...");
            $("#cidade").val("...");
            $("#estado").val("...");
            $("#rua").prop('disabled', true);
            $("#bairro").prop('disabled', true);
            $("#cidade").prop('disabled', true);
            $("#estado").prop('disabled', true);

            //Consulta o webservice viacep.com.br/
            $.getJSON("https://viacep.com.br/ws/"+ cep +"/json/?callback=?", function(dados) {
              if (!("erro" in dados)) {
                //Atualiza os campos com os valores da consulta.
                $("#rua").val(dados.logradouro);
                $("#bairro").val(dados.bairro);
                $("#cidade").val(dados.localidade);
                $("#estado").val(dados.uf);
                $("#rua").prop('disabled', true);
                $("#bairro").prop('disabled', true);
                $("#cidade").prop('disabled', true);
                $("#estado").prop('disabled', true);
              } //end if.
              else {
                //CEP pesquisado não foi encontrado.
                limpa_formulario_cep();
                alert("CEP não encontrado.");
              }
            });
          } //end if.
          else {
            //cep é inválido.
            limpa_formulario_cep();
            alert("Formato de CEP inválido.");
          }
      } //end if.
      else {
        //cep sem valor, limpa formulário.
        limpa_formulario_cep();
      }
    });
	});
</script>
